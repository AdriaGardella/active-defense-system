# =====================================================
# Active Defense System — Suricata Custom Rules
# Ubicación en el servidor: /var/lib/suricata/rules/local.rules
# =====================================================

# Rule 1: ICMP Ping Flood Detection
# Se activa cuando una misma IP envía más de 10 pings por segundo
alert icmp any any -> $HOME_NET any (msg:"[ADS] ICMP Ping Flood Detected"; itype:8; threshold: type threshold, track by_src, count 10, seconds 1; classtype:attempted-dos; sid:1000001; rev:1;)

# Rule 2: TCP Port Scan Detection
# Se activa cuando una misma IP envía más de 20 paquetes SYN en 5 segundos
alert tcp any any -> $HOME_NET any (msg:"[ADS] Possible Port Scan Detected"; flags:S,12; threshold: type threshold, track by_src, count 20, seconds 5; classtype:attempted-recon; sid:1000002; rev:1;)

# Rule 3: ICMP Ping Detection (Test Rule)
# Se activa con cualquier ping individual — útil para verificar que el sistema funciona
alert icmp any any -> $HOME_NET any (msg:"[ADS] ICMP Ping Detected - TEST"; itype:8; sid:1000003; rev:1;)

# Rule 4: SSH Brute Force Attempt
# Se activa cuando una misma IP hace más de 5 conexiones al puerto 22 en 60 segundos
alert tcp any any -> $HOME_NET 22 (msg:"[ADS] SSH Brute Force Attempt"; flow:to_server,established; threshold: type threshold, track by_src, count 5, seconds 60; classtype:attempted-admin; sid:1000004; rev:1;)
